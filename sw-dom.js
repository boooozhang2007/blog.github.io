document.addEventListener("DOMContentLoaded",(()=>{if(!navigator.serviceWorker?.controller)return;const e=e=>{const t=e.endsWith("js")?"script":"link",o="link"===t?"href":"src";for(let s of document.getElementsByTagName(t)){const n=s[o];if(e.length>n?e.endsWith(n):n.endsWith(e)){const e=document.createElement(t),o=s.text||s.textContent||s.innerHTML||"";return Array.from(s.attributes).forEach((t=>e.setAttribute(t.name,t.value))),e.appendChild(document.createTextNode(o)),s.parentNode.replaceChildren(e,s),!0}}},t="updated";var o;sessionStorage.getItem(t)?(onSuccess(),sessionStorage.removeItem(t)):(o="update",navigator.serviceWorker.controller.postMessage(o)),navigator.serviceWorker.addEventListener("message",(o=>{const s=o.data;sessionStorage.setItem(t,s.type);const n=s.list?.filter((e=>/\.(js|css)$/.test(e)));if(n)window.Pjax?.isSupported?.()&&n.forEach(e),location.reload();else{const e=s.new,o=s.old;!o||e.global===o.global&&e.local===o.local||onSuccess(),sessionStorage.removeItem(t)}}))}));